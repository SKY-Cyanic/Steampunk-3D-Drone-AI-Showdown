# 🎮 게임 메커니즘 확장 - 완성 가이드

## ✅ 구현 완료된 기능

### 1. 전투 시스템 ⚔️

#### 미사일 발사
- **플레이어**: `F` 키로 미사일 발사
- **AI**: 자동으로 플레이어를 향해 미사일 발사 (난이도별 정확도 다름)
- **쿨다운 시스템**: 연속 발사 방지 (플레이어 1.0초, AI 1.5초)
- **예측 사격**: AI가 플레이어의 이동을 예측하여 발사

#### 충돌 감지
- 실시간 미사일-드론 충돌 체크
- 충돌 시 폭발 이펙트 생성
- 데미지 계산 및 HP 감소

#### 데미지 시스템
- 기본 데미지: 20
- 업그레이드에 따라 데미지 증가 가능
- HP가 0이 되면 사망 → 리스폰

### 2. 점수 및 보상 시스템 💯

#### 점수 획득
```
킬 (AI 격추): +100 점수, +50 경험치, +10 코인
명중: +10 점수, +5 경험치, +1 코인
생존 시간 (1분마다): +20 점수, +10 경험치, +2 코인
```

#### 레벨 시스템
- **경험치**: 행동에 따라 획득
- **레벨업**: 필요 경험치 = 레벨 × 100
- **레벨업 보상**: 레벨 × 50 코인
- **특별 보상**: 5레벨마다 +500 코인 보너스

#### 코인 시스템
- 전투 보상으로 획득
- 업그레이드 구매에 사용
- 세션 종료 시 점수의 10%를 코인으로 전환

### 3. 티어 시스템 🏆

#### 7단계 티어
| 티어 | 레이팅 범위 | 색상 |
|------|-------------|------|
| 🥉 브론즈 | 0 ~ 999 | #cd7f32 |
| 🥈 실버 | 1000 ~ 1499 | #c0c0c0 |
| 🥇 골드 | 1500 ~ 1999 | #ffd700 |
| 💎 플래티넘 | 2000 ~ 2499 | #e5e4e2 |
| 💠 다이아몬드 | 2500 ~ 2999 | #b9f2ff |
| 👑 마스터 | 3000 ~ 3499 | #9d4edd |
| ⭐ 레전드 | 3500+ | #ff006e |

#### ELO 레이팅 시스템
- **승리**: +25 레이팅
- **패배**: -15 레이팅
- **5킬 이상**: +10 보너스
- **성과 보너스**: KDA에 따라 추가 레이팅

### 4. 업그레이드 시스템 💪

#### 4가지 업그레이드
```
🚀 속도: 레벨당 +5% 속도 증가
🛡️ 방어력: 레벨당 +10 HP 증가
⚔️ 공격력: 레벨당 +5 데미지 증가
⚡ 발사속도: 레벨당 쿨다운 -5% 감소
```

#### 비용
- 기본 비용: 100 코인
- 레벨당 추가: +50 코인
- 최대 레벨: 10

---

## 🎮 게임 플레이 가이드

### 조작법
```
W: 전진
S: 후진
A: 좌측 이동
D: 우측 이동
Space: 상승
Shift: 하강
F: 미사일 발사 🚀
```

### 전투 팁
1. **거리 유지**: AI와 10~20m 거리 유지가 최적
2. **장애물 활용**: 톱니바퀴와 파이프 뒤에 숨어 미사일 회피
3. **예측 사격**: 이동 중인 AI를 앞서 조준
4. **업그레이드 우선순위**: 
   - 초반: 방어력 (생존력)
   - 중반: 공격력 (킬 효율)
   - 후반: 속도 + 발사속도 (기동성)

### 점수 최대화 전략
1. AI를 빠르게 격추 (5킬 이상 → 레이팅 보너스)
2. 미사일 명중률 높이기
3. 오래 생존 (1분마다 보상)
4. 레벨업 → 코인 획득 → 업그레이드 → 더 강해짐

---

## 🔧 백엔드 API 구조

### WebSocket 메시지 타입

#### 클라이언트 → 서버
```javascript
// 플레이어 위치 업데이트
{
    type: 'player_update',
    position: [x, y, z],
    velocity: [vx, vy, vz]
}

// 미사일 발사
{
    type: 'fire_missile',
    direction: [dx, dy, dz]  // 정규화된 방향 벡터
}

// 업그레이드 요청
{
    type: 'upgrade',
    upgrade_type: 'speed' | 'armor' | 'damage' | 'fire_rate'
}
```

#### 서버 → 클라이언트
```javascript
// 초기화
{
    type: 'init',
    client_id: string,
    ai_drone_id: string,
    obstacles: [...],
    player_data: {...},
    ai_data: {...}
}

// AI 업데이트
{
    type: 'ai_update',
    ai_state: {
        position: [x, y, z],
        velocity: [vx, vy, vz],
        hp: number,
        max_hp: number
    }
}

// 게임 상태
{
    type: 'game_state',
    missiles: [...],  // 모든 활성 미사일
    match_duration: number
}

// 데미지 받음
{
    type: 'damage_taken',
    damage: number,
    hp: number,
    max_hp: number,
    attacker_id: string,
    explosion_position: [x, y, z]
}

// 명중 확인
{
    type: 'hit_confirmed',
    target_id: string,
    damage: number,
    target_hp: number,
    explosion_position: [x, y, z]
}

// 킬 확인
{
    type: 'kill_confirmed',
    target_id: string,
    rewards: {
        score_reward: number,
        exp_reward: number,
        coin_reward: number,
        level_up_rewards: [...]
    },
    player_data: {...}
}

// 사망
{
    type: 'player_died',
    killer_id: string
}

// 리스폰
{
    type: 'respawned',
    player_data: {...}
}

// 업그레이드 결과
{
    type: 'upgrade_result',
    success: boolean,
    upgrade_type: string,
    player_data: {...}
}
```

---

## 📊 데이터베이스 구조 (향후 확장용)

```python
# 플레이어 데이터 (영구 저장 필요 시)
{
    'player_id': str,
    'username': str,
    'level': int,
    'experience': int,
    'rating': int,  # ELO
    'tier': str,
    'coins': int,
    'stats': {
        'kills': int,
        'deaths': int,
        'games_played': int,
        'wins': int,
        'total_damage_dealt': float,
        'missiles_fired': int,
        'missiles_hit': int
    },
    'upgrades': {
        'speed_level': int,
        'armor_level': int,
        'damage_level': int,
        'fire_rate_level': int
    }
}
```

---

## 🎨 UI 구성

### 화면 레이아웃
```
┌─────────────────────────────────────────────┐
│  [상태]  [플레이어 HP 바 (녹색)]              │
│                                             │
│  [정보패널]                    [점수패널]     │
│  - 레벨                        - 킬          │
│  - 티어                        - 점수        │
│  - 코인                                     │
│  - 경험치바                                  │
│                                             │
│            [3D 게임 화면]                    │
│                                             │
│                                             │
│  [조작법]                      [업그레이드]   │
│                                - 속도       │
│                                - 방어력     │
│                                - 공격력     │
│  [AI HP 바 (빨간색)]            - 발사속도   │
└─────────────────────────────────────────────┘
```

### 실시간 피드백
- **데미지 받음**: 빨간 테두리 + 알림
- **명중**: 초록 테두리 + 점수 표시
- **킬**: 큰 알림 + 보상 표시
- **레벨업**: 축하 알림 + 코인 획득
- **티어 승급**: 특별 알림 + 티어 배지 변경

---

## 🚀 향후 추가 기능 아이디어

### Phase 2: 추가 게임 메커니즘
1. **파워업 아이템**
   - 속도 부스터 (10초간 2배 속도)
   - 실드 (3번 데미지 무시)
   - 더블 데미지 (10초간 2배 데미지)

2. **특수 무기**
   - 레이저 빔 (즉발식 공격)
   - 유도 미사일 (자동 추적)
   - 스플래시 미사일 (범위 데미지)

3. **환경 요소**
   - 이동하는 플랫폼
   - 위험 지역 (용암, 전기장)
   - 날씨 효과 (안개, 비)

### Phase 3: 소셜 기능
1. **매치 메이킹**: 비슷한 티어끼리 매칭
2. **리플레이**: 멋진 킬 순간 다시보기
3. **친구 시스템**: 친구 추가 및 초대
4. **길드/클랜**: 팀 결성 및 길드전

### Phase 4: 수익화 고도화
1. **시즌 패스**: 독점 스킨 및 보상
2. **배틀 패스**: 50레벨 보상 체계
3. **스킨 마켓**: 커스텀 드론 외형
4. **VIP 멤버십**: 광고 제거 + 경험치 부스트

---

## 🐛 알려진 이슈 & 개선 사항

### 현재 제한사항
1. **플레이어 데이터 영구 저장 안됨**: 새로고침 시 초기화
2. **한 명만 플레이 가능**: 멀티플레이어 미구현
3. **AI 난이도 고정**: 'normal'로 고정 (향후 선택 가능하게)

### 개선 예정
1. **데이터베이스 연동**: PostgreSQL 또는 MongoDB
2. **인증 시스템**: 로그인/회원가입
3. **서버 최적화**: 더 많은 동시 접속자 처리
4. **그래픽 개선**: 더 정교한 3D 모델, 파티클 효과

---

## 📝 개발자 노트

### 파일 구조
```
/workspace/
├── backend/
│   ├── main.py              # 메인 서버 (WebSocket, 게임 루프)
│   ├── player.py            # 플레이어 데이터 관리
│   ├── ai_drone.py          # AI 드론 로직
│   └── game_mechanics.py    # 전투 시스템, 보상, 레이팅
├── frontend/
│   └── index.html           # 3D 게임 UI (1300+ 줄)
├── requirements.txt         # Python 의존성
└── README.md                # 프로젝트 문서
```

### 핵심 클래스
- **Player**: 플레이어 상태, 스탯, 업그레이드 관리
- **AIDrone**: AI 행동 로직, 전투 AI
- **CombatSystem**: 미사일 생성, 충돌 감지
- **RewardSystem**: 점수, 경험치, 코인 계산
- **EloRatingSystem**: 티어 레이팅 관리

---

## 🎉 축하합니다!

3D 드론 AI 대전 시뮬레이터의 **전투 시스템, 점수 시스템, 티어 시스템**이 모두 구현되었습니다!

### 다음 단계
1. 서버 실행: `python backend/main.py`
2. 브라우저 접속: `http://localhost:8000`
3. F키로 미사일 발사해보기
4. AI를 격추하고 레벨업하기
5. 코인으로 업그레이드 구매하기
6. 더 높은 티어 달성하기!

**행운을 빕니다! 🚁✨**
